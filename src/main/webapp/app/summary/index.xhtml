<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:body>
        <ui:composition template="/WEB-INF/template.xhtml">

            <ui:define name="pageTitle">#{msg.sum_title}</ui:define>

            <ui:define name="mainpage">

                <h:outputStylesheet library="css" name="summary.css"/>
                <h:outputStylesheet library="css" name="timeline.css"/>
                <h:outputStylesheet library="primefaces" name="grid/grid.css"/>
                <h:outputScript library="primefaces" name="jquery/jquery.js" />

                <div id="summary-content">

                    <h1 class="mobileCentered">#{summaryBean.observationName}</h1>

                    <h2 class="mobileCentered">#{msg.sum_title}</h2>

                    <div class="inline-bar mobileCentered">
                        <div class="inline-bar align-bar">
                            <div>
                                <div id="total-records" class="total"></div>
                                <div><span>#{msg.sum_totalRecordings}</span></div>
                            </div>
                            <div>
                                <div id="total-duration" class="total"></div>
                                <div><span>#{msg.sum_duration}</span></div>
                            </div>
                        </div>
                        <div class="inline-bar align-bar">
                            <div class="timeframe">
                                <div>
                                    <p:inputMask id="input-timeframeStart" value="00:00:00"
                                                 mask="99:99:99" autocomplete="false"
                                                 size="6" placeholder="hh:mm:ss"
                                                 title="#{msg.sum_timeFrameTitle}">
                                        <f:validateRegex pattern="(^$|^__:__:__$|^(\d+:)?(\d+:)?\d+$)" />
                                        <p:clientValidator event="keyup"/>
                                    </p:inputMask>
                                </div>
                                <div>
                                    <span>#{msg.sum_timeFrameStart}</span>
                                </div>
                            </div>
                            <div class="timeframe">
                                <div>
                                    <p:inputMask id="input-timeframeEnd"
                                                 mask="99:99:99" autocomplete="false"
                                                 size="6" placeholder="hh:mm:ss"
                                                 title="#{msg.sum_timeFrameTitle}">
                                        <f:validateRegex pattern="(^$|^__:__:__$|^(\d+:)?(\d+:)?\d+$)" />
                                        <p:clientValidator event="keyup"/>
                                    </p:inputMask>
                                </div>
                                <div>
                                    <span>#{msg.sum_timeFrameEnd}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="recordings-details" class="ui-fluid">
                    <h3>#{msg.sum_recordings}</h3>
                    <div class="ui-grid ui-grid-responsive-480">
                        <div class="ui-grid-row header-row">
                            <div class="ui-grid-col-5">#{msg.sum_category}</div>
                            <div class="ui-grid-col-3">#{msg.sum_number}</div>
                            <div class="ui-grid-col-3">#{msg.sum_duration}</div>
                        </div>
                    </div>
                    <div id="records" class="ui-grid ui-grid-responsive-480"/>
                </div>

                <pe:timeline id="timeline" widgetVar="timelineWdgt"
                             value="#{summaryBean.timeline}"
                             timeZone="#{timeBean.serverTimeZone}"
                             browserTimeZone="#{timeBean.userTimeZone}"
                             min="#{summaryBean.min}"
                             max="#{summaryBean.max}"
                             start="#{summaryBean.start}"
                             zoomMin="#{summaryBean.zoomMin}"
                             zoomMax="#{summaryBean.zoomMax}"
                             selectable="true"
                             zoomable="false"
                             moveable="true"
                             animate="false"
                             animateZoom="false"
                             axisOnTop="true"
                             groupsOrder="false"
                             groupsChangeable="false"
                             groupMinHeight="16"
                             editable="false"
                             timeChangeable="true"
                             showCurrentTime="false"
                             showMajorLabels="false"
                             stackEvents="false"
                             eventMarginAxis="0"
                             eventMargin="16">
                </pe:timeline>

                <div id="timelineControls">
                    <div>
                        <span>#{msg.sum_zoom} </span>
                        <a id="button-zoom-out" class="fa fa-search-minus" title="#{msg.sum_zoomOut}"></a>
                        <a id="button-zoom-in" class="fa fa-search-plus" title="#{msg.sum_zoomIn}"></a>
                        <a href="#summary-content"><span> Takaisin yl√∂s</span><span class="fa fa-chevron-circle-up"></span></a>
                    </div>
                </div>

                <p:dialog header="#{msg.sum_mailDialogHeader}"
                          widgetVar="dlgMail"
                          position="top"
                          resizable="false"
                          responsive="true"
                          fitViewport="true"
                          styleClass="coloredButton">
                    <h:form styleClass="dialog-form ui-fluid">
                        <p:inputText id="input-name"
                                     value="#{summaryBean.observationName}"
                                     placeholder="#{msg.sum_observationName}"/>
                        <p:inputText id="input-target"
                                     value="#{summaryBean.observationTarget}"
                                     placeholder="#{msg.sum_observationTarget}"/>
                        <p:inputTextarea id="input-description"
                                         value="#{summaryBean.observationDescription}"
                                         placeholder="#{msg.sum_observationDescription}"
                                         rows="3" cols="16" autoResize="true" />
                        <h:outputText value="#{msg.sum_giveEmail}"/>
                        <p:inputText id="input-email"
                                     placeholder="#{msg.sum_emailAddress}" />
                        <p:commandButton value="#{msg.sum_sendMail}" icon="ui-icon-check"
                                         onclick="PF('dlgMail').hide();"
                                         actionListener="#{buttonView.buttonAction}" />
                    </h:form>
                </p:dialog>
                <p:dialog header="#{msg.sum_saveDialogHeader}"
                          widgetVar="dlgSave"
                          position="top"
                          resizable="false"
                          responsive="true"
                          fitViewport="true"
                          styleClass="coloredButton">
                    <h:form styleClass="dialog-form ui-fluid">
                        <p:inputText id="input-name"
                                     value="#{summaryBean.observationName}"
                                     placeholder="#{msg.sum_observationName}"/>
                        <p:inputText id="input-target"
                                     value="#{summaryBean.observationTarget}"
                                     placeholder="#{msg.sum_observationTarget}"/>
                        <p:inputTextarea id="input-description"
                                         value="#{summaryBean.observationDescription}"
                                         placeholder="#{msg.sum_observationDescription}"
                                         rows="3" cols="16" autoResize="true" />
                        <p:commandButton value="#{msg.sum_save}" icon="ui-icon-check"
                                         onclick="PF('dlgSave').hide();"
                                         actionListener="#{buttonView.buttonAction}"/>
                    </h:form>
                </p:dialog>

                <p:growl id="growl" widgetVar="growlWdgt" severity="info" showDetail="true" sticky="true" escape="false" />

                <h:outputScript>
                    var SummaryIndex = {
                    getObservationDuration: function () {
                    return #{summaryBean.observationDuration};
                    },
                    getMessages: function (){
                    return msg = {
                    sum_total: "#{msg.sum_total}",
                    sum_begin: "#{msg.sum_begin}",
                    sum_end: "#{msg.sum_end}",
                    sum_duration: "#{msg.sum_duration}",
                    sum_countAbr: "#{msg.sum_countAbr}"
                    };
                    },
                    };
                </h:outputScript>
                <h:outputScript library="js" name="summary.js"/>
            </ui:define>
        </ui:composition>
    </h:body>
</html>
